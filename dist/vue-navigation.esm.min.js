/**
* vue-navigation v1.1.4
* https://github.com/zack24q/vue-navigation
* Released under the MIT License.
*/
function genKey(){return"xxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}function getKey(t,e){return t+"__navigation_routers_index"+(e?"__"+e:"")}function matches(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"==typeof t?t.split(",").indexOf(e)>-1:!!isRegExp(t)&&t.test(e)}var routes=[];window.sessionStorage.VUE_NAVIGATION&&(routes=JSON.parse(window.sessionStorage.VUE_NAVIGATION));var getRoutesMap=function(){return routes.reduce(function(t,e){return t[e.path]=e.key,t},{})},Routes=routes,mergePush=Routes.push.bind(Routes);Routes.push=function(t){var e=t.path,n=t.key;Routes.forEach(function(t){return t.path===e&&(t.key=n)}),mergePush(t)};var Navigator=function(t,e,n,o){e&&e.registerModule(n,{state:{routes:Routes},mutations:{"navigation/FORWARD":function(t,e){e.to,e.from;var n=e.name;t.routes.push({path:n,key:genKey()})},"navigation/BACK":function(t,e){e.to,e.from;var n=e.count;t.routes.splice(t.routes.length-n,n)},"navigation/REPLACE":function(t,e){e.to,e.from;var n=e.name;t.routes.splice(Routes.length-1,1,{path:n,key:genKey()})},"navigation/REFRESH":function(t,e){e.to,e.from},"navigation/RESET":function(t){t.routes.splice(0,t.routes.length)}}});var a=function(o,a,i,r){var s={route:a},u={route:i},c=e?e.state[n].routes:Routes;u.name=(c[c.length-1]||{}).path||null,s.name=o,e?e.commit("navigation/FORWARD",{to:s,from:u,name:o}):c.push({path:o,key:genKey()}),window.sessionStorage.VUE_NAVIGATION=JSON.stringify(c),t.$emit("forward",s,u)},i=function(o,a,i){var r={route:a},s={route:i},u=e?e.state[n].routes:Routes;s.name=u[u.length-1].path,r.name=u[u.length-1-o].path,e?e.commit("navigation/BACK",{to:r,from:s,count:o}):u.splice(Routes.length-o,o),window.sessionStorage.VUE_NAVIGATION=JSON.stringify(u),t.$emit("back",r,s)},r=function(o,a,i){var r={route:a},s={route:i},u=e?e.state[n].routes:Routes;s.name=u[u.length-1].path||null,r.name=o,e?e.commit("navigation/REPLACE",{to:r,from:s,name:o}):u.splice(Routes.length-1,1,{path:o,key:genKey()}),window.sessionStorage.VUE_NAVIGATION=JSON.stringify(u),t.$emit("replace",r,s)},s=function(o,a){var i={route:o},r={route:a},s=e?e.state[n].routes:Routes;i.name=r.name=s[s.length-1].path,e&&e.commit("navigation/REFRESH",{to:i,from:r}),t.$emit("refresh",i,r)};return{record:function(t,e,n,o){var u=t.path;n?r(u,t,e):!getRoutesMap()[u]||o?a(u,t,e):u===Routes[Routes.length-1].path?s(t,e):i(1,t,e)},reset:function(){e?e.commit("navigation/RESET"):Routes.splice(0,Routes.length),window.sessionStorage.VUE_NAVIGATION=JSON.stringify([]),t.$emit("reset")}}},NavComponent=function(t){return{name:"navigation",abstract:!0,props:{},data:function(){return{routes:Routes}},computed:{},watch:{routes:function(t){var e=t.map(function(t){return t.path+"__navigation_routers_index__"+t.key});for(var n in this.cache)if(!matches(e,n)){var o=this.cache[n];o&&o.componentInstance.$destroy(),delete this.cache[n]}}},created:function(){this.cache={}},destroyed:function(){for(var t in this.cache){var e=this.cache[t];e&&e.componentInstance.$destroy()}},render:function(){var t=this.$slots.default?this.$slots.default[0]:null;if(t){t.key=t.key||(t.isComment?"comment":t.tag);var e=getRoutesMap(),n=getKey(this.$route.path,e[this.$route.path]);-1===t.key.indexOf(n)&&(t.key="__navigation-"+n+"-"+t.key),this.cache[n]?t.key===this.cache[n].key?t.componentInstance=this.cache[n].componentInstance:(this.cache[n].componentInstance.$destroy(),this.cache[n]=t):this.cache[n]=t,t.data.keepAlive=!0}return t}}},index={install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.router,o=e.store,a=e.moduleName,i=void 0===a?"navigation":a,r=e.keyName,s=void 0===r?"VNK":r;if(n){var u=new t,c=Navigator(u,o,i,s),h=n.replace.bind(n),f=n.push.bind(n),g=!1,m=!1;n.replace=function(t,e,n){g=!0,h(t,e,n)},n.push=function(t,e,n){m=!0,f(t,e,n)},n.afterEach(function(t,e){var n=(Routes[Routes.length-2]||{}).path!==t.path;c.record(t,e,g,m||n),g=!1,m=!1}),t.component("navigation",NavComponent(s)),t.navigation=t.prototype.$navigation={on:function(t,e){u.$on(t,e)},once:function(t,e){u.$once(t,e)},off:function(t,e){u.$off(t,e)},getRoutes:function(){return Routes.slice()},cleanRoutes:function(){return c.reset()}}}else console.error("vue-navigation need options: router")}};export default index;